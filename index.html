<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <title>邀请函</title>
    <link href="resource/global.css" rel="stylesheet" />
    <link href="resource/style.css" rel="stylesheet" />
    <script src="resource/fastclick.js"></script>
    <script src="resource/jweixin-1.2.0.js"></script>
    <script src="resource/jquery.min.js"></script>
    <style>
        .loader,
        .loader:before,
        .loader:after { background: #FFF; -webkit-animation: load 1s infinite ease-in-out; animation: load 1s infinite ease-in-out; width: 6px; height: 30px; }
        .loader:before,
        .loader:after { position: absolute; top: 0; content: ''; }
        .loader:before { left: -10px; -webkit-animation-delay: -0.32s; animation-delay: -0.32s; }
        .loader:after { left: 10px; }
        .loader { position: absolute; top: 200px; left: 50%; -webkit-animation-delay: -0.16s; animation-delay: -0.16s; }
        .loader .text { position: absolute; top: 50px; color: #fff; width: 26px; left: -10px; font-size: 13px; text-align: center; }

        @-webkit-keyframes load {
            0%, 80%, 100% { box-shadow: 0 0 #fff; height: 30px; }
            40% { box-shadow: 0 -10px #fff; height: 40px; }
        }

        @keyframes load {
            0%, 80%, 100% { box-shadow: 0 0 #fff; height: 30px; }
            40% { box-shadow: 0 -10px #fff; height: 40px; }
        }
    </style>
</head>
<body>
    <div class="pageWrapped full">
        <div class="background full" data-page="1"></div>
        <div class="pageContainer full" data-show="0" is-page="0">
            <div class="mainpart">
                <div class="loader">
                    <div class="text" id="LoadingScheduleText">0%</div>
                </div>
            </div>
        </div>
        <div class="pageContainer full" data-show="0" is-page="1">
            <img class="zoomsign fx1" src="resource/cloud1.png" style="position: absolute; top: 0; right: 0; width: 160px;" />
            <img class="zoomsign fx2" src="resource/cloud2.png" style="position: absolute; bottom: 0; left: 0; width: 115px;" />
            <div class="mainpart">
                <img class="fx3" src="resource/text1.png" style="position: absolute; top:115px; left: 50%; width: 196px;margin-left:-98px" />
                <img class="fx4" src="resource/text2.png" style="position: absolute; top: 160px; left: 50%; width: 276px; margin-left: -138px; " />
                <img class="fx5" src="resource/text3.png" style="position: absolute; top: 206px; left: 50%; width: 296px; margin-left: -148px; " />
                <img class="fx6" src="resource/text4.png" style="position: absolute; top: 338px; left: 50%; width: 234px; margin-left: -117px; " />
                <img class="fx7" src="resource/text5.png" style="position: absolute; top: 414px; left: 50%; width: 250px; margin-left: -125px; " />
            </div>
        </div>
        <div class="pageContainer full" data-show="0" is-page="1">
            <div class="mainpart">
                <img class="fx8" src="resource/text6.png" style="position: absolute; top:95px; left: 50%; width: 250px;margin-left:-125px" />
                <img class="fx9" src="resource/text7.png" style="position: absolute; top:210px; left: 50%; width: 246px;margin-left:-123px" />
                <img class="fx10" src="resource/text8.png" style="position: absolute; top:268px; left: 50%; width: 268px;margin-left:-134px" />
                <img class="fx11" src="resource/text9.png" style="position: absolute; top:300px; left: 50%; width: 304px;margin-left:-152px" />
                <img class="fx12" src="resource/text10.png" style="position: absolute; top:358px; left: 50%; width: 170px;margin-left:-85px" />
                <img class="fx13" src="resource/text11.png" style="position: absolute; top:480px; left: 50%; width: 256px;margin-left:-128px" />
            </div>
        </div>
        <div class="pageContainer full" data-show="0" is-page="1">
            <div class="mainpart">
                <img class="fx24" src="resource/border1.png" style="position: absolute; top:40px; left: 50%; width: 312px;margin-left:-151px" />
                <div style="position:absolute;left:60px;top:60px;width:264px;">
                    <p class="typerfx" style="color: #70cef2;font-size:16px;font-weight:bold;">尊敬的先生/女士：</p>
                    <p class="typerfx" style="color: #fff; font-size: 16px;line-height:24px;margin-top:6px;text-indent:2em;">为了更好执行国家“建设新型智慧城市”战略方针，提高广西智慧城市便民服务发展水平，通过信息化技术更好地推动广西企业的发展，广西移动精心组织了“云创未来”移动信息化训展活动，深入全区地市，搭建智慧城市、云计算、物联网的现场体验平台，带来丰富多彩的信息化应用展示，此项活动即将在南宁开展，期待您的参与。</p>
                    <div style="font-weight: bold; color: #fff; font-size: 15px;line-height:22px; ">
                        <div class="fx14">
                            <p style="margin-top: 40px;">活动时间：<span style="color: #f9b52c;">2017年12月7日(星期四)</span></p>
                            <p style="text-indent: 74px; color: #f9b52c; ">上午8:00至下午5:00</p>
                        </div>
                        <div class="fx15">
                            <p style="">活动地点：<span style="color: #f9b52c;">南宁国际会展中心朱瑾花厅</span></p>
                            <p style="text-indent: 74px;">[南宁市名族大道东段106号]</p>
                        </div>
                    </div>
                </div>
                <div class="fx16" style="position: absolute; left: 60px; top: 556px; right: 60px; text-align: center;color:#fff;font-size:15px;line-height:24px;">
                    <p style="">广西壮族自治区工业和信息化委员会</p>
                    <p style="">中国移动通信集团广西有限公司</p>
                </div>
            </div>
        </div>
        <div class="pageContainer full" data-show="0" is-page="1">
            <div class="mainpart">
                <img class="fx17" src="resource/text12.png" style="position: absolute; top:60px; left: 50%; width: 290px;margin-left:-145px" />
                <img class="fx19" src="resource/map.png" style="position: absolute; top:148px; left: 50%; width: 344px;margin-left:-172px" />
                <img class="fx20" src="resource/sketch.png" style="position: absolute; top:486px; left: 50%; width: 302px;margin-left:-151px" />
            </div>
        </div>
        <div class="pageContainer full" data-show="0" is-page="1">
            <div class="mainpart">
                <img class="fx21" src="resource/border2.png" style="position: absolute; top:64px; left: 50%; width: 250px;margin-left:-125px" />
                <img class="fx22" src="resource/text13.png" style="position: absolute; top:116px; left: 50%; width: 226px;margin-left:-113px" />
                <img class="fx23" src="resource/text14.png" style="position: absolute; top:558px; left: 50%; width: 212px;margin-left:-106px" />
            </div>
        </div>
        <div class="nextPageButton hide"><img src="resource/nextPageWrite.png" /></div>
    </div>
    <div class="musicButton hide" data-state="1"></div>
    <script>
        //滑动式翻页
        var SlidPageTurnFunc = {
            //当前页
            page: 1,
            //计时器
            timer1: null,
            //总页数
            totalpage: 1,
            //是否可翻页
            isPageTurn: false,
            //储存跳转到每一页时的操作
            toEachPageHandle: {},
            //元素
            element: {
                typerfx: $('.typerfx'),
                zoomsign: $('.zoomsign'),
                mainpart: $('.mainpart'),
                background: $('.background'),
                musicButton: $('.musicButton'),
                pageWrapped: $('.pageWrapped'),
                pageContainer: $('.pageContainer'),
                nextPageButton: $('.nextPageButton'),
                LoadingScheduleText: $('#LoadingScheduleText')
            },
            //初始化
            init: function () {
                var s = this;
                var updateZoom = function () {
                    var ratio = Math.min(window.innerWidth / 375, window.innerHeight / 667);
                    s.element.mainpart.each(function () {
                        $(this).css({
                            'transform': 'translate3d(-50%,-50%,0) scale3d(' + ratio + ',' + ratio + ',1)'
                        });
                    });
                    s.element.zoomsign.each(function () {
                        var init_ratio = 1;
                        var _width = Number(this.getAttribute('data-width'));
                        var _height = Number(this.getAttribute('data-height'));
                        if (_width) {
                            init_ratio = _width / this.naturalWidth;
                            $(this).css({
                                'width': _width * ratio,
                                'height': this.naturalHeight * init_ratio * ratio
                            });
                        } else if (_height) {
                            init_ratio = _height / this.naturalHeight;
                            $(this).css({
                                'width': this.naturalWidth * init_ratio * ratio,
                                'height': _height * ratio
                            });
                        }
                    });
                };
                //保存初始大小
                s.element.zoomsign.each(function () {
                    this.setAttribute('data-width', this.clientWidth);
                    this.setAttribute('data-height', this.clientHeight);
                });
                $(window).resize(updateZoom);
                $(window).resize();
                //加载资源
                s.element.pageContainer.eq(s.page - 1).attr('data-show', 1);
                s.loadResource({
                    data: [
                        { type: 'img', url: 'resource/back1.jpg' },
                        { type: 'img', url: 'resource/back2.jpg' },
                        { type: 'img', url: 'resource/back3.jpg' },
                        { type: 'img', url: 'resource/back4.jpg' },
                        { type: 'img', url: 'resource/border1.png' },
                        { type: 'img', url: 'resource/border2.png' },
                        { type: 'img', url: 'resource/cloud1.png' },
                        { type: 'img', url: 'resource/cloud2.png' },
                        { type: 'img', url: 'resource/map.png' },
                        { type: 'img', url: 'resource/nextPageWrite.png' },
                        { type: 'img', url: 'resource/sketch.png' },
                        { type: 'img', url: 'resource/text1.png' },
                        { type: 'img', url: 'resource/text2.png' },
                        { type: 'img', url: 'resource/text3.png' },
                        { type: 'img', url: 'resource/text4.png' },
                        { type: 'img', url: 'resource/text5.png' },
                        { type: 'img', url: 'resource/text6.png' },
                        { type: 'img', url: 'resource/text7.png' },
                        { type: 'img', url: 'resource/text8.png' },
                        { type: 'img', url: 'resource/text9.png' },
                        { type: 'img', url: 'resource/text10.png' },
                        { type: 'img', url: 'resource/text11.png' },
                        { type: 'img', url: 'resource/text12.png' },
                        { type: 'img', url: 'resource/text13.png' },
                        { type: 'img', url: 'resource/text14.png' },
                        { type: 'audio', url: 'resource/backmusic.mp3' }
                    ]
                });
            },
            //准备就绪
            ready: function () {
                var s = this;
                $(window).resize();
                //初始化打字机动画元素
                s.element.typerfx.each(function () {
                    var html = '';
                    [].forEach.call(this.innerText, function (item) {
                        html += '<span class="textfx">' + item + '</span>';
                    });
                    this.innerHTML = html;
                });
                //初始化背景音乐
                var backmusic = new Audio();
                backmusic.src = 'resource/backmusic.mp3';
                audioAutoPlay(backmusic);
                s.element.musicButton.click(function () {
                    switch (this.getAttribute('data-state')) {
                        case '0':
                            backmusic.play();
                            this.setAttribute('data-state', 1);
                            break;
                        case '1':
                            backmusic.pause();
                            this.setAttribute('data-state', 0);
                            break;
                    }
                }).removeClass('hide');
                //事件
                s.element.pageWrapped.on('touchstart', function (e) {
                    s.interactive.down({
                        clientY: e.originalEvent.changedTouches[0].clientY
                    });
                    e.preventDefault();
                });
                s.element.pageWrapped.on('touchend', function (e) {
                    s.interactive.lift({
                        clientY: e.originalEvent.changedTouches[0].clientY
                    });
                    e.preventDefault();
                });
                s.element.pageWrapped.on('mousedown', function (e) {
                    s.interactive.down({
                        clientY: e.originalEvent.clientY
                    });
                    e.preventDefault();
                });
                s.element.pageWrapped.on('mouseup', function (e) {
                    s.interactive.lift({
                        clientY: e.originalEvent.clientY
                    });
                    e.preventDefault();
                });
                //初始化完成
                s.totalpage = s.element.pageContainer.length;
                s.toIndexPage(2);
            },
            //加载资源
            loadResource: function (option) {
                var s = this;
                var index = 0;
                var length = option.data.length;
                var complete = function () {
                    index += 1;
                    if (index === length) {
                        s.ready();
                    }
                    s.element.LoadingScheduleText.text(Math.floor(index / length * 100) + '%');
                };
                var ajaxLoad = function (url) {
                    xhr = new XMLHttpRequest();
                    xhr.open('get', url);
                    xhr.onload = xhr.onerror = complete;
                    xhr.send();
                };
                var loadImage = function (url) {
                    var img = new Image();
                    img.onload = img.onerror = complete;
                    img.src = url;
                };
                option.data.forEach(function (item) {
                    switch (item.type) {
                        case 'img':
                            loadImage(item.url);
                            break;
                        default:
                            ajaxLoad(item.url);
                            break;
                    }
                });
            },
            //跳转到指定页
            toIndexPage: function (index) {
                var s = this;
                var page = s.page;
                if (index >= 2 && index <= s.totalpage) {
                    s.page = index;
                    s.isPageTurn = true;
                    s.toEachPageHandle[index] && s.toEachPageHandle[index].call(s);
                    //动画开始
                    clearTimeout(s.timer1);
                    s.element.nextPageButton.addClass('hide');
                    s.element.background.attr('data-page', s.page);
                    var last = s.element.pageContainer.eq(page - 1);
                    var curr = s.element.pageContainer.eq(s.page - 1);
                    last.attr('data-show', 0);
                    curr.attr('data-show', 1);
                    if (s.page < s.totalpage) {
                        switch (curr.attr('is-page')) {
                            case '0':
                                s.isPageTurn = false;
                                break;
                            case '1':
                                s.isPageTurn = true;
                                s.timer1 = setTimeout(function () {
                                    s.element.nextPageButton.removeClass('hide');
                                }, 2000);
                                break;
                        }
                    }
                    //设置文字动画延迟时间
                    var textfx1 = curr.find('.textfx');
                    textfx1.each(function (i) {
                        $(this).css({
                            'animation-name': 'textfx',
                            'animation-delay': i * 30 + 'ms'
                        });
                    });
                    var textfx2 = last.find('.textfx');
                    textfx2.each(function (i) {
                        $(this).css({
                            'animation-name': '',
                            'animation-delay': ''
                        });
                    });
                }
            },
            //交互
            interactive: {
                //手势翻页阀值
                threshold: 50,
                //记录按下时的位置
                downPos: null,
                //手指按下
                down: function (data) {
                    var s = SlidPageTurnFunc;
                    if (s.isPageTurn) {
                        s.interactive.downPos = {
                            clientY: data.clientY
                        };
                    }
                },
                //手指提起
                lift: function (data) {
                    var s = SlidPageTurnFunc;
                    if (s.interactive.downPos) {
                        var clientY = data.clientY;
                        if (clientY - s.interactive.downPos.clientY > s.interactive.threshold) {
                            //向下滑
                            s.toIndexPage(s.page - 1);
                        } else if (clientY - s.interactive.downPos.clientY < -s.interactive.threshold) {
                            //向上滑
                            s.toIndexPage(s.page + 1);
                        }
                        s.interactive.downPos = null;
                    }
                }
            }
        };
        SlidPageTurnFunc.init();
        //自动播放音频
        function audioAutoPlay(audio) {
            var play = function () {
                audio.play();
                document.removeEventListener("touchstart", play, false);
            };
            audio.play();
            document.addEventListener("WeixinJSBridgeReady", function () {
                play();
            }, false);
            document.addEventListener('YixinJSBridgeReady', function () {
                play();
            }, false);
            document.addEventListener("touchstart", play, false);
        };
    </script>
</body>
</html>
